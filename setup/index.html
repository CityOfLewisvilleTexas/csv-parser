<!DOCTYPE html>
<html>

<head>
    <title>Uploader Setup</title>
    <link rel="stylesheet" type="text/css" href="style.css" media="screen" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="shortcut icon" href="http://metrics.cityoflewisville.com/assets/pmartin_dark.png" />
    <link href='https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Material+Icons' rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/vuetify/dist/vuetify.min.css" rel="stylesheet">
    <link rel="stylesheet" src="style.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.js"></script>
    <script src="https://unpkg.com/vue/dist/vue.js"></script>
    <!-- <script src="https://cdn.jsdelivr.net/npm/vuetify/dist/vuetify.js"></script> -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vuetify/1.2.0/vuetify.js"></script>
    <!-- <script type="text/javascript" src="./moment/moment.js"></script> -->
</head>

<body>
    <div id="app" v-cloak>
        <v-app class="indigo">
            <v-container>
                <v-layout>
                    <v-flex>
                        <v-stepper v-model="stepper" light>
                            <v-stepper-header>
                                <v-stepper-step :complete="stepper > 1" step="1">Choose a table</v-stepper-step>
                                <v-divider></v-divider>
                                <v-stepper-step :complete="stepper > 2" step="2">Set table mask</v-stepper-step>
                                <v-divider></v-divider>
                                <v-stepper-step step="3">Settings</v-stepper-step>
                            </v-stepper-header>
                            <v-stepper-items>
                                <!-- choosing a table -->
                                <v-stepper-content step="1" class="blue-grey lighten-4">
                                    <v-layout row wrap>
                                        <v-flex xs12>
                                            <p class="subheading">Choose a table to upload to. If it doesn't appear, create it at <code>[AX1VSQL8].[CSVUploadApp]</code></p>
                                        </v-flex>
                                        <v-flex xs12 lg5 mb-3>
                                            <v-select
                                                v-model="selected.table"
                                                :items="tables"
                                                label="Tables"
                                                :loading="isLoading.tables"
                                                :disabled="isLoading.tables"
                                                solo>
                                            </v-select>
                                        </v-flex>
                                    </v-layout>
                                    <v-btn color="primary" @click="stepper = 2" :disabled="isLoading.tables || !selected.table">
                                        Continue
                                    </v-btn>
                                </v-stepper-content>
                                <!--  mask the table -->
                                <v-stepper-content step="2" class="blue-grey lighten-4">
                                    <v-layout row wrap>
                                        <v-flex xs12>
                                            <p class="subheading">Choose a mask for your table. Must be unique.</p>
                                        </v-flex>
                                        <v-flex xs12 lg5 mb-3>
                                            <v-text-field
                                                :loading="isLoading.masks"
                                                :disabled="isLoading.masks"
                                                v-model="mask"
                                                label="Mask"
                                                prepend-icon="autorenew"
                                                @click:prepend="fillWithRandomMask('mask')"
                                                solo>
                                            </v-text-field>
                                            <v-alert
                                                type="error"
                                                :value="!isUniqueMask(mask)">
                                                Mask is not unique.
                                            </v-alert>
                                        </v-flex>
                                    </v-layout>
                                    <v-btn color="primary" @click="stepper = 3" :disabled="isLoading.masks || !isUniqueMask(mask)">
                                        Continue
                                    </v-btn>
                                </v-stepper-content>
                                <!-- general settings for the uploader -->
                                <v-stepper-content step="3" class="blue-grey lighten-4">
                                    <v-card>
                                        <v-card-text>
                                            <v-checkbox :disabled="isLoading.columns" v-model="hasColumnMapping" label="Column Mapping"></v-checkbox>
                                            <v-layout ml-5 v-if="hasColumnMapping" row wrap>
                                                <v-flex xs12>
                                                    <p>This is where you make a direct link between the spreadsheet headers and the table columns. Only do so if you know the spreadsheet headers will not change.</p>
                                                </v-flex>
                                                <v-flex xs12 lg4 mr-3 v-for="(col,idx) in columns" :key="idx">
                                                    <v-text-field
                                                        :label="col">
                                                    </v-text-field>
                                                </v-flex>
                                            </v-layout>
                                        </v-card-text>
                                    </v-card>
                                    <v-btn color="primary" @click="">
                                        Done!
                                    </v-btn>
                                </v-stepper-content>
                            </v-stepper-items>
                        </v-stepper>
                    </v-flex>
                </v-layout>
            </v-container>
        </v-app>
    </div>
    <!-- source code -->
    <script type="text/javascript" src="app.js"></script>
</body>